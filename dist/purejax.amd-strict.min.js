define(["exports"],function(exports){"use strict";function type(value){return null===value?value+"":"object"==typeof value||"function"==typeof value?typeMap[toString.call(value)]||"object":typeof value}function isPlainObject(value){return"object"!==type(value)||value.nodeType||null!==value&&value===value.window?!1:value.constructor&&!hasOwnProperty.call(value.constructor.prototype,"isPrototypeOf")?!1:!0}function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},index=1,length=arguments.length,deep=!1;for("boolean"===type(target)&&(deep=target,target=arguments[index]||{},index++),"object"!==type(target)&&"function"!==type(target)&&(target={});length>index;index++)if(options=arguments[index],null!==options)for(name in options)src=target[name],copy=options[name],target!==copy&&(copyIsArray=isArray(copy),deep&&copy&&(isPlainObject(copy)||copyIsArray)?(copyIsArray?(copyIsArray=!1,clone=src&&isArray(src)?src:[]):clone=src&&isPlainObject(src)?src:{},target[name]=extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target}function xhr(){return XMLHttpRequest?new XMLHttpRequest:createActiveXObject("Microsoft.XMLHTTP")}function paramify(data,delimiter){var key,value,index,result=[];delimiter="undefined"==typeof delimiter?!0:delimiter,delimiter=delimiter?"?":"",data=data||{};for(key in data)if(data.hasOwnProperty(key))if(value=data[key],isArray(value))for(index=0;index<value.length;index++)result.push(encodeURIComponent(key)+"[]="+encodeURIComponent(value[index]));else result.push(encodeURIComponent(key)+"="+encodeURIComponent(data[key]));return result=result.join("&"),(result.length>0?delimiter:"")+result}function createTimeoutError(ms){var error=new Error("Timeout of "+ms+" reached");return error.timeout=ms,error.isTimeoutError=!0,error}function jsonp(options,callback){function cleanUp(){script.parentNode&&script.parentNode.removeChild(script),window[id]=function(){},current&&clearTimeout(current)}var id,current,script=document.createElement("script");return count++,id=id=prefix+count,window[id]=function(data){cleanUp(),callback(null,data)},options.timeout&&(current=setTimeout(function(){cleanUp(),callback(createTimeoutError(options.timeout),null)},options.timeout)),script.setAttribute("type","text/javascript"),options.params.callback=id,script.setAttribute("src",options.url+paramify(options.params)),rootNode.parentNode.insertBefore(script,rootNode),function(){window[id]&&cleanUp()}}function http(options,callback){var request,send,current,isTimeoutTriggered;request=xhr(),options.timeout&&(current=setTimeout(function(){isTimeoutTriggered=!0,callback(createTimeoutError(options.timeout),null),request.abort()},options.timeout)),request.onreadystatechange=function(){var statusCode,error;isTimeoutTriggered||request.readyState<4||(statusCode=parseInt(request.status,10),statusCode>=200&&300>statusCode?callback(null,request.responseText):(error=new Error('Invalid status code "'+statusCode+'"'),error.statusCode=statusCode,callback(error,null)),current&&clearTimeout(current))},"GET"===options.method?request.open("GET",options.url+paramify(options.params),!0):"POST"===options.method&&(request.open("POST",options.url),request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),send=paramify(options.params,!1)),request.send(send)}function purejax(options,callback){var isPromiseAvailable="Promise"in window;if(options=extend({url:null,method:"GET",timeout:7e3,cache:!1,params:{},headers:{},jsonp:!1},options),options.method=options.method.toUpperCase(),options.cache||(options.params[cacheKey]=+new Date),isPromiseAvailable&&!callback)return new Promise(function(resolve,reject){purejax(options,function(error,response){return error?reject(error):void resolve(response)})});if(!isPromiseAvailable&&"function"!=typeof callback)throw new Error("Invalid callback obtained");return(options.jsonp?jsonp:http)(options,callback)}var rootNode=document.getElementsByTagName("script")[0]||document.head,count=0,prefix="___pj",cacheKey="_",isArray=void 0,XMLHttpRequest=window.XMLHttpRequest,createActiveXObject=window.ActiveXObject,typeMap={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error","[object Symbol]":"symbol"},toString=typeMap.toString,hasOwnProperty=typeMap.hasOwnProperty;isArray=Array.isArray?Array.isArray:function(value){return"[object Array]"===Object.prototype.toString.call(value)},exports["default"]=purejax});